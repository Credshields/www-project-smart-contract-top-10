## آسیب‌پذیری: آسیب‌پذیری‌های محدودیت گس

### توضیحات: 
در اتریوم و دیگر پلتفرم‌های بلاکچینی، هر عملیات انجام شده توسط یک قرارداد هوشمند مقدار مشخصی گس مصرف می‌کند که یک واحد تلاش محاسباتی است. محدودیت گس بلاک حداکثر مقدار گسی است که می‌تواند در یک بلاک استفاده شود. اگر یک تابع در قرارداد هوشمند برای تکمیل اجرای خود به گسی بیشتر از محدودیت گس بلاک نیاز داشته باشد، تراکنش با شکست مواجه می‌شود. این نوع آسیب‌پذیری به‌ویژه در حلقه‌هایی که روی ساختارهای داده داینامیک مانند آرایه‌ها یا لیست‌ها تکرار می‌کنند رایج است، جایی که تعداد تکرارها ثابت نیست و می‌تواند به‌صورت دلخواه زیاد شود.

### Example :
```
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;

contract TokenTransfer {
    mapping(address => uint256) public balances;

    function transfer(address _to, uint256 _amount) public {
        require(balances[msg.sender] >= _amount, "Insufficient balance");
        
        for (uint256 i = 0; i < _amount; i++) {  // The loop iterates _amount times, which can be very inefficient and can potentially exceed the block gas limit if _amount is too large.
            balances[msg.sender]--; 
            balances[_to]++; 
        }
    }
}
```
### شدت آسیب‌پذیری:
- توابعی که به مشکلات محدودیت گس حساس هستند ممکن است غیرقابل اجرا شوند و منجر به قفل شدن وجوه یا فریزشدن وضعیت قرارداد شوند. وقتی این توابع به دلیل فراتر از حد مجاز گس نتوانند به پایان برسند، هرگونه وجه مرتبط با تراکنش غیرقابل دسترس می‌شود و عملاً در داخل قرارداد قفل می‌گردد.

### راهکارهای امنیتی:
- توابع باید اعتبارسنجی کنند که کاربران نمی‌توانند طول متغیر استفاده‌شده در حلقه را کنترل کنند که باعث پیمایش مقدار زیادی داده شود. اگر حذف آن ممکن نباشد، باید محدودیتی برای طول آن مطابق با منطق کد تعریف شود.
  
- هر زمان که در Solidity از حلقه‌ها استفاده می‌شود، توسعه‌دهندگان باید به‌دقت اقدامات انجام‌شده در داخل حلقه را بررسی کنند تا مطمئن شوند که تراکنش گس بیش از حد مصرف نمی‌کند و از حد گس تجاوز نمی‌کند.

