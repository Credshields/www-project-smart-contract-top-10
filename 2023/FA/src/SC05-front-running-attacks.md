## آسیب‌پذیری: حملات Front-Running

### توضیحات: 
حمله front-running زمانی اتفاق می‌افتد که شخصی نسبت به تراکنشی که قرار انجام شود اطلاعاتی دارد و می‌تواند به نفع خودش این موضوع رو پیش ببرد.این نوع حمله به ویژه در پلتفرم های دیفای (DeFi) شایع است. مهاجمان با بررسی تراکنشی های ممپول(mempool) می‌توانند تراکنش مورد نظر خودشان را با پرداخت هزینه بیشتر GAS بالاتر از تراکنش اشخاص دیگر قراردهند و این اطمینان را داشته باشند که تراکنششان زودتر از تراکنش مورد نظر پردازش می‌شود. این موضوع منجر به خسارات مالی قابل توجهی می‌شود.

### مثال :
```
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;

contract VulnerableSwap {
    address public pancakeRouter;
    address public ssToken;

    constructor(address _pancakeRouter, address _ssToken) {
        pancakeRouter = _pancakeRouter;
        ssToken = _ssToken;
    }

    function swapBNBForSSToken(uint256 amount) private {
        address[] memory path = new address[](2);
        path[0] = IPancakeRouter02(pancakeRouter).WETH();
        path[1] = ssToken;

        IPancakeRouter02(pancakeRouter).swapExactETHForTokensSupportingFeeOnTransferTokens{
            value: amount
        }(0, path, address(this), block.timestamp);
    }
}
```

*یادداشت: در مثال فوق، کاربری می‌خواهد BNB را با SSToken مبادله کند. با این حال، تابع فاقد بررسی‌های مناسب slippage است و این موضوع قرارداد را در معرض حملات front-running قرار می‌دهد. یک مهاجم می‌تواند یک تراکنش بزرگ مبادله را رصد کرده و تراکنش خود را با هزینه گاز بالاتر قرار دهد تا قبل از تراکنش هدف پردازش شود، که منجر به اجرای تراکنش قربانی با نرخ نامناسب‌تری می‌شود.*

### شدت آسیب پذیری:
- قربانیان ممکن است به‌طور قابل توجهی برای یک توکن بیشتر پرداخت کنند یا کمتر از آنچه که انتظار داشتند دریافت کنند، به دلیل ترتیب دستکاری‌شده تراکنش‌ها.

- مهاجمان می‌توانند قیمت توکن‌ها را به‌صورت مصنوعی افزایش یا کاهش دهند، با انجام معاملات بزرگ قبل از دیگران.

- 
  
### راهکارهای امنیتی:
- پیاده‌سازی محدودیت‌های slippage بین 0.1% و 5%، بسته به هزینه‌های شبکه و اندازه مبادله، برای جلوگیری از سوءاستفاده front-runnerها از نرخ‌های slippage بالاتر.

- استفاده از یک فرایند دو مرحله‌ای که در آن کاربران به یک عمل متعهد می‌شوند بدون اینکه جزئیات را فاش کنند، سپس اطلاعات دقیق را بعداً افشا کنند. این کار پیش‌بینی و سوءاستفاده از تراکنش‌ها را برای مهاجمان دشوارتر می‌کند.

- گروه‌بندی چندین تراکنش و پردازش آن‌ها به‌عنوان یک واحد، که این کار شناسایی و سوءاستفاده از معاملات فردی را برای مهاجمان دشوارتر می‌کند.

- ظارت مستمر بر ربات‌ها و اسکریپت‌های خودکار که ممکن است از فرصت‌های front-running سوءاستفاده کنند، که به شناسایی زودهنگام و کاهش خطر کمک می‌کند.
